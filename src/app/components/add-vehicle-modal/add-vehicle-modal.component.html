<div
  class="bg-white rounded-lg shadow-xl max-w-5xl w-full max-h-[95vh] overflow-hidden flex flex-col modal-container"
>
  <div class="flex items-center justify-between p-6 border-b border-gray-200">
    <h2 class="text-xl font-semibold text-gray-900">
      {{ isEditMode ? 'Editar Veículo' : 'Adicionar Novo Veículo' }}
    </h2>
    <button
      type="button"
      (click)="closeModal()"
      class="text-gray-400 hover:text-gray-600 transition-colors"
    >
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M6 18L18 6M6 6l12 12"
        ></path>
      </svg>
    </button>
  </div>

  <div class="flex-1 overflow-y-auto p-6 modal-content">
    <form [formGroup]="vehicleForm" (ngSubmit)="onSubmit()" class="space-y-6">
      <div class="space-y-4">
        <label for="photo" class="block text-sm font-medium text-gray-700"
          >URL da Foto do Veículo</label
        >

        <input
          id="photo"
          type="url"
          formControlName="photo"
          placeholder="https://exemplo.com/foto-veiculo.jpg"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          [class.border-red-500]="
            vehicleForm.get('photo')?.invalid && vehicleForm.get('photo')?.touched
          "
        />

        @if (getFieldError('photo')) {
          <p class="mt-1 text-sm text-red-600">{{ getFieldError('photo') }}</p>
        }

        @if (photoUrl) {
          <div class="mt-4">
            <div class="relative inline-block">
              <img
                [src]="photoUrl"
                alt="Preview"
                class="w-32 h-32 object-cover rounded-lg border-2 border-gray-200"
                (error)="clearPhoto()"
              />
              <button
                type="button"
                (click)="clearPhoto()"
                class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors"
              >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M6 18L18 6M6 6l12 12"
                  ></path>
                </svg>
              </button>
            </div>
            <p class="mt-2 text-sm text-gray-500">Preview da imagem</p>
          </div>
        }
      </div>

      <!-- Primeira linha: Placa, Modelo e Marca -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div>
          <label for="placa" class="block text-sm font-medium text-gray-700 mb-2">Placa *</label>
          <input
            id="placa"
            type="text"
            formControlName="placa"
            placeholder="ABC-1234"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent uppercase"
            [class.border-red-500]="
              vehicleForm.get('placa')?.invalid && vehicleForm.get('placa')?.touched
            "
          />
          @if (getFieldError('placa')) {
            <p class="mt-1 text-sm text-red-600">{{ getFieldError('placa') }}</p>
          }
        </div>

        <div>
          <label for="modelo" class="block text-sm font-medium text-gray-700 mb-2">Modelo *</label>
          <input
            id="modelo"
            type="text"
            formControlName="modelo"
            placeholder="Ex: Civic, Corolla, Gol"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            [class.border-red-500]="
              vehicleForm.get('modelo')?.invalid && vehicleForm.get('modelo')?.touched
            "
          />
          @if (getFieldError('modelo')) {
            <p class="mt-1 text-sm text-red-600">{{ getFieldError('modelo') }}</p>
          }
        </div>

        <div>
          <label for="marca" class="block text-sm font-medium text-gray-700 mb-2">Marca *</label>
          <input
            id="marca"
            type="text"
            formControlName="marca"
            placeholder="Ex: Honda, Toyota, Volkswagen"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            [class.border-red-500]="
              vehicleForm.get('marca')?.invalid && vehicleForm.get('marca')?.touched
            "
          />
          @if (getFieldError('marca')) {
            <p class="mt-1 text-sm text-red-600">{{ getFieldError('marca') }}</p>
          }
        </div>
      </div>

      <!-- Segunda linha: Ano, Chassi e Renavam -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div>
          <label for="ano" class="block text-sm font-medium text-gray-700 mb-2">Ano *</label>
          <input
            id="ano"
            type="number"
            formControlName="ano"
            placeholder="2023"
            min="1900"
            max="2030"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            [class.border-red-500]="
              vehicleForm.get('ano')?.invalid && vehicleForm.get('ano')?.touched
            "
          />
          @if (getFieldError('ano')) {
            <p class="mt-1 text-sm text-red-600">{{ getFieldError('ano') }}</p>
          }
        </div>

        <div>
          <label for="chassi" class="block text-sm font-medium text-gray-700 mb-2">Chassi</label>
          <input
            id="chassi"
            type="text"
            formControlName="chassi"
            placeholder="17 caracteres"
            maxlength="17"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm"
            [class.border-red-500]="
              vehicleForm.get('chassi')?.invalid && vehicleForm.get('chassi')?.touched
            "
          />
          @if (getFieldError('chassi')) {
            <p class="mt-1 text-sm text-red-600">{{ getFieldError('chassi') }}</p>
          }
        </div>

        <div>
          <label for="renavam" class="block text-sm font-medium text-gray-700 mb-2">Renavam</label>
          <input
            id="renavam"
            type="text"
            formControlName="renavam"
            placeholder="11 dígitos"
            maxlength="11"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono"
            [class.border-red-500]="
              vehicleForm.get('renavam')?.invalid && vehicleForm.get('renavam')?.touched
            "
          />
          @if (getFieldError('renavam')) {
            <p class="mt-1 text-sm text-red-600">{{ getFieldError('renavam') }}</p>
          }
        </div>
      </div>

      <div>
        <label for="descricao" class="block text-sm font-medium text-gray-700 mb-2"
          >Descrição</label
        >
        <textarea
          id="descricao"
          formControlName="descricao"
          rows="4"
          placeholder="Informações adicionais sobre o veículo..."
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
          [class.border-red-500]="
            vehicleForm.get('descricao')?.invalid && vehicleForm.get('descricao')?.touched
          "
        ></textarea>
        @if (getFieldError('descricao')) {
          <p class="mt-1 text-sm text-red-600">{{ getFieldError('descricao') }}</p>
        }
        <p class="mt-1 text-sm text-gray-500">
          {{ vehicleForm.get('descricao')?.value?.length || 0 }}/500 caracteres
        </p>
      </div>
    </form>
  </div>

  <div class="flex justify-end gap-3 p-6 border-t border-gray-200">
    <button
      type="button"
      (click)="closeModal()"
      class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors"
    >
      Cancelar
    </button>
    <button
      type="submit"
      (click)="onSubmit()"
      [disabled]="
        !vehicleForm.get('placa')?.value ||
        !vehicleForm.get('modelo')?.value ||
        !vehicleForm.get('marca')?.value
      "
      class="px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
    >
      {{ isEditMode ? 'Salvar Alterações' : 'Adicionar Veículo' }}
    </button>
  </div>
</div>
